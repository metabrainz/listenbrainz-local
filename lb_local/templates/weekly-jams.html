{%- extends 'base.html' -%}
{%- block title -%}home{% endblock %}
{%- block content -%}

<h2>ListenBrainz Local Weekly Jams</h2>

<p>
    Generate a playlist from a users weekly recommendations. You can generate a playlist as
    many times as you'd like in a week, but the underying recommendations only update each monday.
</p>

<form hx-post="/weekly-jams"
      hx-target="#lb-local-playlist"
      hx-swap="outerHTML"
  <fieldset>
    <label for="prompt">User</label>
    <input type="text"
           name="user_name"
           placeholder="joe_user"
           style="width: 40%"
           value="rob">
    <input class="button-primary"
           type="submit"
           value="Generate"
           hx-indicator="#spinner"
           hx-on:click="document.getElementById('lb-local-playlist').innerHTML = ''">
  </fieldset>
  <div style="text-align: center; width: 100%">
    <img id="spinner"
         class="htmx-indicator"
         src="{{ url_for('static', filename='img/spinner.svg') }}">
    </img>
  </div>
</form>

<form id="lb-local-playlist">
</form>

{% endblock%}

{% block scripts %}
<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", () => {
          init_player("{{ subsonic.host }}", {{ subsonic.port }}, "{{ subsonic.args }}");
    });

    function leave_page() {
        console.log("leave page");
        document.getElementById("lb-local-playlist").innerHTML = "";
        stop();
    }
</script>
{% endblock %}
